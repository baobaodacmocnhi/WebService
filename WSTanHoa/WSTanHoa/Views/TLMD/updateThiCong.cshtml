@model WSTanHoa.Models.MThiCong
@{
    ViewBag.Title = "Cập Nhật Thi Công";
}

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>@ViewBag.Title</title>
<script src="~/Scripts/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        $("#IDQuan").change(function () {
            getPhuong();
        });
    });
    function getTTKH() {
        if ($("#inputDanhBo").val().length == 11)
            $.ajax({
                type: 'GET',
                url: '/TLMD/getTTKH/',
                dataType: 'json',
                data: { DanhBo: $("#inputDanhBo").val() },
                success: function (data) {
                    $("#inputDiemDau").val(data.SoNha);
                    $("#inputDiemCuoi").val(data.SoNha);
                    $("#inputTenDuong").val(data.TenDuong);
                },
                error: function (ex) {
                    alert("Error: " + ex.statusText);
                }
            });
    };
    function getPhuong() {
        $("#IDPhuong").html("");
        $.ajax({
            type: 'GET',
            url: '/TLMD/getPhuong/',
            dataType: 'json',
            data: { Quan: $("#IDQuan").val() },
            success: function (data) {
                $.each(data, function (i, item) {
                    $("#IDPhuong").append($("<option     />").val(item.SoNha).text(item.TenDuong));
                });
            },
            error: function (ex) {
                alert("Error: " + ex.statusText);
            }
        });
    };

</script>
<div class="container bg-light mt-3 py-2 rounded-3 shadow-sm">
    @using (Html.BeginForm("updateThiCong", "TLMD", FormMethod.Post))
    {
        <div class="row">
            <div class="col-2">
                <label for="inputID" class="form-label">@Html.DisplayNameFor(model => model.ID)</label>
                <input type="number" class="form-control" name="inputID" value="@Html.DisplayFor(model => model.ID)" hidden="">
            </div>
            <div class="col-12 mt-3 form-group">
                <label for="inputName" class="form-label">@Html.DisplayNameFor(model => model.Name)</label>
                <input type="text" class="form-control" name="inputName" value="@Html.DisplayFor(model => model.Name)" />
            </div>
            <div class="col-3 mt-3">
                <label for="inputDanhBo" class="form-label">@Html.DisplayNameFor(model => model.DanhBo)</label>
                <input type="text" class="form-control" id="inputDanhBo" name="inputDanhBo" value="@Html.DisplayFor(model => model.DanhBo)" onchange="getTTKH()" />
            </div>
            <div class="col-3 mt-3">
                <label for="inputDiemDau" class="form-label">@Html.DisplayNameFor(model => model.DiemDau)</label>
                <input type="text" class="form-control" id="inputDiemDau" name="inputDiemDau" value="@Html.DisplayFor(model => model.DiemDau)" />
            </div>
            <div class="col-3 mt-3">
                <label for="inputDiemCuoi" class="form-label">@Html.DisplayNameFor(model => model.DiemCuoi)</label>
                <input type="text" class="form-control" id="inputDiemCuoi" name="inputDiemCuoi" value="@Html.DisplayFor(model => model.DiemCuoi)" />
            </div>
            <div class="col-3 mt-3">
                <label for="inputTenDuong" class="form-label">@Html.DisplayNameFor(model => model.TenDuong)</label>
                <input type="text" class="form-control" id="inputTenDuong" name="inputTenDuong" value="@Html.DisplayFor(model => model.TenDuong)" />
            </div>
            <div class="col-4 mt-3">
                <label for="inputIDQuan" class="form-label">@Html.DisplayNameFor(model => model.IDQuan)</label>
                @Html.DropDownListFor(model => model.IDQuan, ViewBag.Quan as SelectList, new { @class = "form-control", @onchange = "" })
            </div>
            <div class="col-4 mt-3">
                <label for="inputIDPhuong" class="form-label">@Html.DisplayNameFor(model => model.IDPhuong)</label>
                @Html.DropDownListFor(model => model.IDPhuong, ViewBag.Phuong as SelectList, new { @class = "form-control" })
                @*<select class="form-control" id="IDPhuong" name="IDPhuong"></select>*@
                <input type="text" class="form-control" id="IDPhuongHide" name="IDPhuongHide" value="@Html.DisplayFor(model => model.IDPhuong)" hidden="hidden" />
            </div>
            <div class="col-4 mt-3">
                <label for="inputIDKetCau" class="form-label">@Html.DisplayNameFor(model => model.IDKetCau)</label>
                @*<input type="text" class="form-control" name="inputIDKetCau" value="@Html.DisplayFor(model => model.IDKetCau)" />*@
                @Html.DropDownListFor(model => model.IDKetCau, ViewBag.KetCau as SelectList, new { @class = "form-control" })
            </div>
            <div class="col-5 mt-6">
                <label for="inputIDDonViThiCong" class="form-label">@Html.DisplayNameFor(model => model.IDDonViThiCong)</label>
                @*<input type="text" class="form-control" name="inputIDDonViThiCong" value="@Html.DisplayFor(model => model.IDDonViThiCong)" />*@
                @Html.DropDownListFor(model => model.IDDonViThiCong, ViewBag.DonViThiCong as SelectList, new { @class = "form-control" })
            </div>
            
            @if (Model == null || Model.ID <= 0)
            {
            }
            else
            {
                <div class="col-3 mt-3">
                    <label for="inputCreateBy" class="form-label">@Html.DisplayNameFor(model => model.CreateBy)</label>
                    <input type="text" class="form-control" id="inputCreateBy" name="inputCreateBy" value="@Html.DisplayFor(model => model.CreateBy)" readonly />
                </div>
                <div class="col-3 mt-3">
                    <label for="inputCreateDate" class="form-label">@Html.DisplayNameFor(model => model.CreateDate)</label>
                    <input type="text" class="form-control" id="inputCreateDate" name="inputCreateDate" value="@Html.DisplayFor(model => model.CreateDate)" readonly />
                </div>
            }
        </div>
        <div class="row">
            <div class="col mt-3">
                @if (Model == null || Model.ID <= 0)
                {
                    <button type="submit" name="Loai" value="insert" class="btn btn-primary">Thêm mới</button>
                }
                else
                {
                    <button type="submit" name="Loai" value="update" class="btn btn-primary">Cập nhật</button>
                }
            </div>
        </div>
    }
</div>